import csv
import datetime
import ipaddress

class FWRule:
    datetime_created: datetime.datetime
    src_address: str
    src_netmask: str
    dst_address: str
    dst_netmask: str
    ports: list[int]
    action: str

    def __init__(self):

        return


def get_all():
    with open(r'C:\Users\HORNET\Downloads\fw_rules_v1.csv', newline='') as csvfile:
        list_of_my_rules = list()
        for row in reader:
            date_time_as_string = row['datetime_created']

            rule = FWRule()
            rule.datetime_created = datetime.datetime.fromisoformat(date_time_as_string)
            rule.action = row['action']
            list_of_my_rules.append(rule)

    return list_of_my_rules

def all_forbidden(get_all):
    new_my_great_list = list()

    for rule in all:
        if rule.action == 'forbid':
            new_my_great_list.append(rule)

    return new_my_great_list
